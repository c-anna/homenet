<!DOCTYPE HTML>

<html>
<head>

<style>
.player {
    background-color: cyan;
    width:350px;
    text-align:center;
    padding:5px;
    border-style:solid;
    border-color:black;
}

p {
    font-size:180%;
}

input {
    font-size:180%;
    text-align:center;
}
</style>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/jquery-ui.min.js"></script>
<link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.9/themes/base/jquery-ui.css" type="text/css" media="all" />


<script>
//Define a new player
function newPlayer(player) {
    var n = player.clone(true);

    n.find('.lifeCounter').text("20");
	n.find('.playerName').val("");
    n.css('display', 'none');
    n.appendTo('#players').show(350);
}

//Bind all buttons to the jQuery UI button styling etc.
$(function () {
    $("button").button()
});


//Bind a click event to the "remove player" button
$(function () {
    $('.removePlayer').click(function () {
        playerElement = $(this).parent();
        playerElement.hide(350);
		playerElement.remove();
    })
});

function lifeChange(element) {
	counterObj = element.siblings(".lifeCounter");
	oldVal = parseInt(counterObj.text());
	incrementer = 0;
	
	if (element.hasClass("lifeUp1")) {
		incrementer = 1;
	} else if (element.hasClass("lifeUp5")) {
		incrementer = 5;
	} else if (element.hasClass("lifeUp10")) {
		incrementer = 10;
	} else if (element.hasClass("lifeDown1")) {
		incrementer = -1;
	} else if (element.hasClass("lifeDown5")) {
		incrementer = -5;
	} else if (element.hasClass("lifeDown10")) {
		incrementer = -10;
	}
	
	newVal = oldVal + incrementer;
    counterObj.text(newVal);
	
	if (newVal <= 0) {
		$('#sad_trombone').trigger('play');
	}
	
	return (oldVal + incrementer);
}

$(document).ready(function() {
	//Bind event handlers to the life change buttons
		//If the user is on a mobile device, we'll use the 'touchstart'
		//event to trigger the life gain or loss. If not, the standard
		//'click' event will do
	if ((/iPhone|iPod|iPad|Android/).test(navigator.userAgent)) {
		//alert("using a touch-enabled agent");
		$(".up, .down").on('touchstart', function( event ) {
			lifeChange($(event.target).closest("button"));
		});
		
	} else {
		console.log("Using a non-touch-enabled agent");
		$(".up, .down").click(function( event ) { 
			lifeChange($(event.target).closest("button")); 
		});
	}
});

</script>

</head>

<body>
<div id=players>
	<div class=player>
		<input class=playerName placeholder="Player name"></input><br />
		
		<button class='lifeUp1 up'>+1</button>
		<button class='lifeUp5 up'>+5</button>
		<button class='lifeUp10 up'>+10</button>

		<p class=lifeCounter>20</p>

		<button class='lifeDown1 down'>-1</button>
		<button class='lifeDown5 down'>-5</button>
		<button class='lifeDown10 down'>-10</button>
		<br /><br />
		<button class=removePlayer>Remove this player</button>
	</div>
</div>

<audio id=sad_trombone type="audio/mpeg" src="sad_trombone.mp3" preload="auto"></audio>

<button onClick="newPlayer($('.player:first'))">Add a new player</button>

</body>
</html>
